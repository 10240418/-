# 白酒品质检测与分析系统

本系统是一个基于Python的白酒品质检测与分析应用程序，采用现代化图形界面，集成了数据分析、机器学习算法，用于实现白酒真伪分类和掺伪量预测分析等功能。系统使用SQLite数据库存储用户信息和分析历史记录，提供了一个全面的白酒品质检测解决方案。

## 系统概述

白酒作为中国传统酒类，其品质检测对于市场监管和消费者权益保护具有重要意义。传统白酒检测方法通常依赖人工感官评价或复杂的化学分析，效率低下且存在主观性。本系统通过整合光谱分析技术和机器学习算法，实现了白酒品质的快速、客观评估，特别是在真伪鉴别和掺伪量分析方面取得了显著成效。

系统具有以下特点：
- **现代化界面**：基于CustomTkinter构建的美观、现代的用户界面
- **数据分析能力**：集成机器学习模型，支持白酒光谱数据的智能分析
- **真伪鉴别**：能够区分真酒、掺水假酒和掺工业酒精假酒
- **掺伪量预测**：对白酒掺假程度进行定量分析
- **可视化展示**：使用Matplotlib绘制分析结果图表
- **历史记录追踪**：保存分析历史，方便回溯查询
- **用户管理**：多用户登录系统，支持用户注册和权限控制

## 技术架构

### 系统架构设计

系统采用前后端分离的设计理念，主要分为以下几个部分：

```
+-------------------+
|    用户界面层     |  <-- CustomTkinter UI 组件
+--------+----------+
         |
         v
+-------------------+
|    业务逻辑层     |  <-- 数据处理、模型加载与预测
+--------+----------+
         |
         v
+-------------------+
|    数据访问层     |  <-- SQLite数据库操作
+--------+----------+
         |
         v
+-------------------+
|    数据存储层     |  <-- SQLite数据库
+-------------------+
```

### 前端技术

1. **CustomTkinter**：基于Tkinter的现代UI库，提供了美观的界面组件
   - 选择理由：兼具Tkinter的兼容性和现代UI的美观性，无需额外依赖
   - 应用：构建所有用户界面，包括登录、分析、分类和历史记录页面

2. **Matplotlib**：强大的数据可视化库
   - 选择理由：与Python深度集成，支持多种图表类型，适合科学数据展示
   - 应用：生成光谱分析图表和结果预测图

### 后端技术

1. **SQLite**：轻量级关系型数据库
   - 选择理由：无需服务器配置，单文件存储，适合桌面应用
   - 应用：存储用户信息和分析历史记录

2. **机器学习模型**：
   - **PyTorch**：用于神经网络模型（条件可用时）
     - 选择理由：强大的深度学习框架，适合复杂分类任务
     - 应用：白酒真伪分类模型
   
   - **Scikit-learn**：传统机器学习算法
     - 选择理由：提供丰富的传统机器学习算法，易于使用
     - 应用：作为PyTorch不可用时的备选方案，以及数据预处理（PCA等）

3. **Pandas & NumPy**：数据处理库
   - 选择理由：高效的数据处理和数值计算能力
   - 应用：光谱数据的读取、处理和分析

## 系统功能模块

### 1. 用户管理模块

- 用户注册：新用户注册账号
- 用户登录：已有用户登录系统
- 密码管理：修改密码和重置密码功能

### 2. 白酒真伪分类模块

- 文件导入：支持Excel和CSV格式的光谱数据导入
- 自动分类：使用机器学习模型自动分类
- 结果展示：显示分类结果和各类别的置信度
- 结果保存：将分析结果保存到历史记录

### 3. 白酒掺伪量分析模块

- 数据导入：支持完整光谱文件和单个样品文件导入
- 数据预处理：包括标准化、MSC校正等
- 分析预测：使用机器学习模型预测掺伪量
- 结果可视化：生成光谱图和预测结果图
- 结果导出：保存分析结果和图表

### 4. 历史记录模块

- 历史浏览：查看历史分析记录
- 结果筛选：按时间、类型等筛选历史结果
- 数据导出：将历史记录导出为TXT或CSV格式

### 5. 系统设置模块

- 外观设置：切换深色/浅色模式和主题颜色
- 参数配置：调整系统分析参数
- 数据清理：清理历史数据和缓存

## 实现步骤

### 环境准备

1. 安装Python 3.8+（推荐Python 3.9或3.10）
2. 安装所需依赖库：
   ```
   pip install customtkinter numpy pandas matplotlib pillow scikit-learn
   pip install torch torchvision # 可选，用于高级模型
   ```

### 项目结构搭建

创建如下项目结构：
```
baijiu_analysis_system/
├── baijiu_app.py               # 主应用入口
├── start_baijiu_app.bat        # Windows启动脚本
├── requirements.txt            # 依赖库列表
├── README.md                   # 项目文档
├── database/                   # 数据库相关
│   ├── db_manager.py           # 数据库管理类
│   ├── init_db.py              # 数据库初始化脚本
│   └── baijiu.db               # SQLite数据库文件
├── components/                 # UI组件
│   ├── login_frame.py          # 登录界面
│   ├── analysis_frame.py       # 掺伪量分析界面
│   ├── classification_frame.py # 真伪分类界面
│   ├── history_frame.py        # 历史记录界面
│   └── settings_frame.py       # 设置界面
├── models/                     # 预训练模型
│   ├── baijiu_classifier.pth   # 分类模型（PyTorch）
│   └── rf_model.pkl            # 回归模型（Scikit-learn）
├── utils/                      # 工具函数
│   ├── data_processor.py       # 数据处理工具
│   └── visualization.py        # 可视化工具
├── logs/                       # 日志文件
└── history/                    # 分析结果保存目录
```

### 开发流程

1. **数据库设计与实现**
   - 设计用户表、设置表和分析历史表
   - 实现数据库管理类和初始化脚本

2. **核心功能模块开发**
   - 实现数据处理和分析算法
   - 开发机器学习模型加载和预测功能

3. **用户界面开发**
   - 设计并实现登录和注册界面
   - 开发白酒真伪分类界面
   - 开发掺伪量分析界面
   - 实现历史记录和设置界面

4. **系统集成与测试**
   - 集成各模块，实现功能间的数据流转
   - 进行系统功能测试和用户体验优化

5. **打包与部署**
   - 使用PyInstaller打包为独立可执行文件
   - 准备安装文档和用户手册

## 工作流程

```
+---------------+
|    启动应用    |
+-------+-------+
        |
        v
+---------------+
|   用户登录     | -------+
+-------+-------+        |
        |                v
        |        +---------------+
        |        |   用户注册     |
        |        +-------+-------+
        |                |
        v                v
+---------------+        |
|   主界面选择   | <------+
+-------+-------+
        |
        +-----------------+------------------+-------------------+
        |                 |                  |                   |
        v                 v                  v                   v
+----------------+ +----------------+ +----------------+ +----------------+
| 掺伪量分析预测 | | 白酒真伪分类   | |  历史记录查看  | |   系统设置     |
+--------+-------+ +--------+-------+ +--------+-------+ +----------------+
        |                 |                  |
        v                 v                  v
+----------------+ +----------------+ +----------------+
|  选择数据文件  | |  选择数据文件  | | 查看分析历史   |
+--------+-------+ +--------+-------+ +--------+-------+
        |                 |                  |
        v                 v                  v
+----------------+ +----------------+ +----------------+
|   数据分析     | |   数据分类     | | 导出分析记录   |
+--------+-------+ +--------+-------+ +----------------+
        |                 |
        v                 v
+----------------+ +----------------+
| 结果可视化展示 | | 结果置信度展示 |
+--------+-------+ +--------+-------+
        |                 |
        v                 v
+----------------+ +----------------+
|  保存分析结果  | |  保存分析结果  |
+----------------+ +----------------+
```

## 快速启动指南

### 方法一：从源码运行

1. 克隆仓库并进入项目目录：
   ```bash
   git clone https://github.com/username/baijiu-analysis-system.git
   cd baijiu-analysis-system
   ```

2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```

3. 初始化数据库：
   ```bash
   python database/init_db.py
   ```

4. 启动应用：
   ```bash
   python baijiu_app.py
   ```

### 方法二：使用可执行文件

在Windows系统下：
1. 下载最新的发布版本
2. 解压缩下载的文件
3. 双击运行 `start_baijiu_app.bat` 或 `baijiu_app.exe`

### 初始账户

- 管理员账户：用户名 `admin`，密码 `admin123`
- 测试用户：用户名 `user1`，密码 `123456`

## 使用方法

1. **登录系统**：
   - 使用预设账户或注册新账户登录系统

2. **掺伪量分析**：
   - 选择"掺伪量分析预测"选项卡
   - 上传完整的Excel格式光谱数据文件或单个样品文件
   - 点击"开始分析"进行处理
   - 查看分析结果和预测图表
   - 可选择保存结果和图表

3. **白酒真伪分类**：
   - 选择"白酒真伪分类"选项卡
   - 上传Excel或CSV格式的光谱数据文件
   - 点击"开始分类"进行分类
   - 查看分类结果和各类别的置信度

4. **查看历史记录**：
   - 选择"历史记录"选项卡
   - 浏览或搜索历史分析记录
   - 可导出历史记录为TXT或CSV格式

5. **系统设置**：
   - 选择"设置"选项卡
   - 调整系统外观和参数设置

## 系统特性

1. **多模型支持**：
   - 优先使用PyTorch深度学习模型
   - 自动降级到Scikit-learn模型（当PyTorch不可用时）

2. **数据预处理**：
   - 自动填充缺失值
   - MSC（多元散射校正）标准化
   - 主成分分析（PCA）降维

3. **结果可靠性评估**：
   - 显示预测结果的置信度
   - 提供不同类别的概率分布

4. **日志记录**：
   - 详细记录系统操作和分析过程
   - 便于问题诊断和系统优化

## 常见问题解答

1. **系统无法启动**
   - 确保安装了所有必要的依赖库
   - 检查Python版本是否为3.8+
   - 查看日志文件 `logs/app.log` 获取详细错误信息

2. **分析结果不准确**
   - 确保上传的光谱数据格式正确
   - 检查数据是否包含所有必要的波长信息
   - 尝试使用系统提供的示例数据进行测试

3. **界面显示异常**
   - 尝试切换系统主题
   - 调整显示分辨率
   - 重启应用程序

## 开发者信息

四川农业大学白酒品质检测系统
© 2024 版权所有 